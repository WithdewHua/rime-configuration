# Rime schema
# encoding: utf-8
# moran: https://github.com/ksqsf/rime-moran
# æ ¹æ®é­”ç„¶æ–¹æ¡ˆè¿›è¡Œä¿®æ”¹
# ä¿®æ”¹ï¼šWithdewHua <i@10101.io>

schema:
  schema_id: moran
  name: é­”ç„¶
  version: "20240617"
  author:
    - è‡ªç„¶ç¢¼ç™¼æ˜äººï¼šå‘¨å¿—è¾²
    - æ–¹æ¡ˆè£½ä½œï¼šksqsf
  description: |
    çˆ²å‚³æ‰¿å­—è¨­è¨ˆçš„è‡ªç„¶ç¢¼åŠè¼”åŠ©ç¢¼æ™ºèƒ½æ•´å¥è¼¸å…¥æ–¹æ¡ˆã€‚
  dependencies:
    - moran_fixed
    - moran_sentence
    - melt_eng               # è‹±æ–‡è¾“å…¥ï¼Œä½œä¸ºæ¬¡ç¿»è¯‘å™¨æŒ‚è½½åˆ°æ‹¼éŸ³æ–¹æ¡ˆ
    - radical_pinyin         # éƒ¨ä»¶æ‹†å­—ï¼Œä½œä¸ºåæŸ¥æŒ‚è½½åˆ°æ‹¼éŸ³æ–¹æ¡ˆ

switches:
  - name: ascii_mode
    states: [ ä¸­æ–‡, è¥¿æ–‡ ]
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
  - name: traditionalization
    states: [ æ±‰å­—, æ¼¢å­— ]
  - name: ascii_punct
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]
  - name: extended_charset
    states: [ é€šç”¨, å¢å»£ ]
  - name: inflexible
    states: [ å‹•è©, å›ºè© ] # ã€Œå›ºè©ã€è¡¨ç¤ºã€Œå›ºé ‚è©ã€
    # é»˜èªæƒ…æ³ä¸‹ï¼Œè¼¸å…¥ 4 ç¢¼æ™‚ï¼Œæœƒç¦æ­¢ç¢¼è¡¨è¼¸å‡ºï¼ˆã€Œå‹•è©ã€æ¨¡å¼ï¼‰ã€‚
    # é€™æ˜¯å› çˆ²ç¢¼è¡¨æœ€å¤§ç¢¼é•·çˆ² 4ï¼Œå¯èƒ½æœƒç”¢ç”Ÿè¼ƒä½é »çš„å¤šå­—è©ï¼Œè¦†è“‹éç”¨æˆ¶è‡ªé€ çš„å¸¸ç”¨è©èªã€‚
    # ç•¶å›ºè©æ¨¡å¼å•“å‹•å¾Œï¼Œè¼¸å…¥ 4 ç¢¼æ™‚æœƒå„ªå…ˆè¼¸å‡ºç¢¼è¡¨ä¸­çš„äºŒå­—è©ï¼Œé€™äº›è¼¸å‡ºå¸¶æœ‰ã€Œâš¡ï¸ã€æ¨™è¨˜ã€‚
  - name: emoji
    states: [ ğŸˆš, ğŸˆ¶ ]
  - name: chaifen
    states: [ ä¸æ‹†, æ‰Œæ–¥ ]
  - name: pinyinhint
    states: [ ğŸ”‡, ğŸ”Š ]
  - name: unicode_comment
    states: [ Ué—œ, Ué–‹ ]
  - options: [ std_opencc,  std_tw, std_hk, std_dzing ]
    reset: 0
    states: [ é€š, è‡º, æ¸¯, å¯ ]

engine:
  processors:
    - key_binder
    - lua_processor@*moran_semicolon_processor
    - lua_processor@*select_character                        # ä»¥è¯å®šå­—
    - ascii_composer
    - recognizer
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - affix_segmentor@radical_lookup
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - table_translator@custom_phrase                         # è‡ªå®šä¹‰çŸ­è¯­ custom_phrase_double.txt
    - table_translator@melt_eng                              # è‹±æ–‡è¾“å…¥
    - table_translator@radical_lookup                        # æ‹†å­—åæŸ¥
    - lua_translator@*moran_express_translator@with_reorder  # ç¿»è­¯å™¨
    - lua_translator@*date_translator                        # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    - lua_translator@*unicode                                # Unicode
    - lua_translator@*number_translator                      # æ•°å­—å¤§å†™
    - history_translator@quick_repeat
  filters:
    - reverse_lookup_filter@radical_reverse_lookup           # æ‹†å­—æ»¤é•œ
    - lua_filter@*moran_charset_filter
    - lua_filter@*moran_reorder_filter
    - lua_filter@*moran_quick_code_hint
    - lua_filter@*moran_aux_hint
    - lua_filter@*reduce_english_filter                      # é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
    - lua_filter@*is_in_user_dict                            # åˆ¤æ–­æ˜¯å¦ä¸ºç”¨æˆ·è¯
    - lua_filter@*autocap_filter                             # è‹±æ–‡å¤§å†™è½¬æ¢
    - lua_filter@*insert_space_between_words                 # è‹±æ–‡è¯å‰åæ’å…¥ç©ºæ ¼
    - simplifier@emoji
    - simplifier@chaifen
    - simplifier@pinyinhint
    - simplifier@std_hk
    - simplifier@std_tw
    - simplifier@std_dzing
    - simplifier@traditionalize                              # ç®€ç¹è½¬æ¢
    - uniquifier                                             # å»é‡

speller:
  alphabet: abcdefghijklmnopqrstuvwxyz/;
  delimiter: " '"
  auto_select: true
  auto_select_pattern: ^;(\w+|;)
  algebra:
    __patch:
      - moran:/algebra/user_force_top?
      - moran:/algebra/user_sentence_top?
      - moran:/algebra/generate_code
      - moran:/algebra/user_sentence_bottom?
      - moran:/algebra/user_force_bottom?

punctuator:
  import_preset: symbols                                     # å¯¼å…¥ symbols

key_binder:
  import_preset: default
  custom_bindings:
    __append:
      # åœ¨é€™è£æ·»åŠ åªåœ¨æœ¬æ–¹æ¡ˆä¸­ç”Ÿæ•ˆçš„æŒ‰éµç¶å®š
  bindings:
    __patch:
      - :/key_binder/custom_bindings?
      - moran:/key_bindings/moran_capital_for_last_syllable
      - moran:/key_bindings/moran_tab
      - moran:/key_bindings/moran_switches

# å¤„ç†ç¬¦åˆç‰¹å®šè§„åˆ™çš„è¾“å…¥ç ï¼Œå¦‚ç½‘å€ã€åæŸ¥
recognizer:
  # ä» default.yaml ç»§æ‰¿é€šç”¨çš„  
  import_preset: default  
  patterns:  # å†å¢åŠ æ–¹æ¡ˆä¸“æœ‰çš„ï¼š
    punct: "^V([0-9]|10|[A-Za-z]+)$"                         # å“åº” symbols.yaml çš„ symbolsï¼Œå¤§å†™ V è§¦å‘
    radical_lookup: "^L[a-z]+$"                              # å“åº”åæŸ¥
    unicode: "^U[a-f0-9]+"                                   # å“åº” Unicode
    number: "^R[0-9]+[.]?[0-9]*"                             # å“åº” number_translator


# ------------
# translators
# ------------
# æ•´å¥è¼¸å…¥æ¨¡å¼è¨­ç½®ï¼Œåœ¨ top_translator ä¸­è¢«èª¿ç”¨
translator:    
  dictionary: rime_cn
  prism: moran
  initial_quality: 5
  max_homophones: 7
  spelling_hints: 3
  contextual_suggestions: true
  preedit_format:
    - xform/([a-z][a-z][a-z][a-z])o/$1Â°/

# å›ºé ‚è¼¸å…¥æ¨¡å¼è¨­ç½®ï¼Œåœ¨ top_translator ä¸­è¢«èª¿ç”¨
fixed:         
  dictionary: moran_fixed_simp
  initial_quality: 100
  enable_completion: false
  enable_sentence: false
  enable_user_dict: false
  enable_encoder: false
  encode_commit_history: true

# æ¬¡ç¿»è¯‘å™¨ï¼Œè‹±æ–‡
melt_eng:
  dictionary: melt_eng                                       # æŒ‚è½½è¯åº“ melt_eng.dict.yaml
  enable_sentence: false                                     # ç¦æ­¢é€ å¥
  enable_user_dict: false                                    # ç¦ç”¨ç”¨æˆ·è¯å…¸
  initial_quality: 1.1                                       # åˆå§‹æƒé‡
  comment_format:                                            # è‡ªå®šä¹‰æç¤ºç 
    - xform/.*//                                             # æ¸…ç©ºæç¤ºç 

# è‡ªå®šç¾©çŸ­èª
custom_phrase: 
  dictionary: ""
  user_dict: custom_phrase_double
  db_class: stabledb
  enable_completion: false                                   # è¡¥å…¨æç¤º
  enable_sentence: false                                     # ç¦æ­¢é€ å¥
  initial_quality: 1000                                      # custom_phrase çš„æƒé‡åº”è¯¥å…¶ä»– dict å¤§

# Lua é…ç½®: æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸã€ISO 8601ã€æ—¶é—´æˆ³çš„è§¦å‘å…³é”®å­—
date_translator:
  date: date            # æ—¥æœŸï¼š 2022-11-29
  time: time            # æ—¶é—´ï¼š 18:13
  week: week            # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
  datetime: datetime    # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
  timestamp: timestamp  # æ—¶é—´æˆ³ï¼š 1669716794


# Lua é…ç½®: é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®ã€‚
# è¯¦ç»†ä»‹ç» https://dvel.me/posts/make-rime-en-better/#çŸ­å•è¯ç½®é¡¶çš„é—®é¢˜
# æ­£å¸¸æƒ…å†µï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.rug 2.å¦‚æœ â€¦â€¦ ã€
# é™ä½ä¹‹åï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.å¦‚æœ 2.rug â€¦â€¦ ã€
# å‡ ç§æ¨¡å¼ï¼š
# all     é™ä½è„šæœ¬å†…ç½®çš„å•è¯ï¼ˆæ‰€æœ‰ 3~4 ä½é•¿åº¦ã€å‰ 2~3 ä½æ˜¯å®Œæ•´æ‹¼éŸ³ã€æœ€åä¸€ä½æ˜¯å£°æ¯ï¼‰ï¼Œwords ä½œä¸ºè‡ªå®šä¹‰çš„é¢å¤–è¡¥å……
# custom  å®Œå…¨è‡ªå®šä¹‰ï¼Œåªé™ä½ words é‡Œçš„
# none    ä¸é™ä½ä»»ä½•å•è¯ï¼Œç›¸å½“äºæ²¡æœ‰å¯ç”¨è¿™ä¸ª Lua
# ï¼ˆåŒ¹é…çš„æ˜¯ç¼–ç ï¼Œä¸æ˜¯å•è¯ï¼‰
reduce_english_filter:
  mode: custom  # all | custom | none
  idx: 2        # é™ä½åˆ°ç¬¬ idx ä¸ªä½ç½®
  # è‡ªå®šä¹‰çš„å•è¯åˆ—è¡¨ï¼Œç¤ºä¾‹åˆ—è¡¨æ²¡æœ‰é™ä½éƒ¨åˆ†å¸¸ç”¨å•è¯ï¼Œå¦‚ and cat mail Mac but bad shit â€¦â€¦
  words: [
    aid, ann,
    bail, bait, bam, band, bans, bat, bay, bend, bent, benz, bib, bid, bien, biz, boc, bop, bos, bud, buf, bach, bench, bush,
    cab, cad, cain, cam, cans, cap, cas, cef, chad, chan, chap, chef, cher, chew, chic, chin, chip, chit, coup, cum, cunt, cur, couch,
    dab, dag, dal, dam, dent, dew, dial, diet, dim, din, dip, dis, dit, doug, dub, dug, dunn,
    fab, fax, fob, fog, foul, fur,
    gag, gail, gain, gal, gam, gaol, ged, gel, ger, guam, gus, gut,
    hail, ham, hank, hans, hat, hay, heil, heir, hem, hep, hud, hum, hung, hunk, hut, hush,
    jim, jug,
    kat,
    lab, lad, lag, laid, lam, laos, lap, lat, lax, lay, led, leg, lex, liam, lib, lid, lied, lien, lies, linn, lip, lit, liz, lob, lug, lund, lung, lux, lash, loch, lush,
    mag, maid, mann, mar, mat, med, mel, mend, mens, ment, mil, mins, mint, mob, moc, mop, mos, mot, mud, mug, mum, mesh,
    nap, nat, nay, neil, nib, nip, noun, nous, nun, nut, nail, nash,
    pac, paid, pail, pain, pair, pak, pal, pam, pans, pant, pap, par, pat, paw, pax, pens, pic, pier, pies, pins, pint, pit, pix, pod, pop, pos, pot, pour, pow, pub, pinch, pouch,
    rand, rant, rent, rep, res, ret, rex, rib, rid, rig, rim, rub, rug, rum, runc, runs, ranch,
    sac, sail, sal, sam, sans, sap, saw, sax, sew, sham, shaw, shin, sig, sin, sip, sis, suit, sung, suns, sup, sur, sus,
    tad, tail, taj, tar, tax, tec, ted, tel, ter, tex, tic, tied, tier, ties, tim, tin, tit, tour, tout, tum,
    wag, wand, womens, wap, wax, weir, won,
    yan, yen,
    zach
  ]

# éƒ¨ä»¶æ‹†å­—åæŸ¥
radical_lookup:
  tag: radical_lookup
  dictionary: radical_pinyin
  enable_user_dict: false
  prefix: "L"  # åæŸ¥å‰ç¼€ï¼ˆåæŸ¥æ—¶å‰ç¼€ä¼šæ¶ˆå¤±å½±å“æ‰“è‹±æ–‡æ‰€ä»¥è®¾å®šä¸ºä¸¤ä¸ªå­—æ¯ï¼Œæˆ–å¯æ”¹æˆä¸€ä¸ªéå­—æ¯ç¬¦å·ï¼‰ï¼Œä¸ recognizer/patterns/radical_lookup åŒ¹é…
  tips: "  ã€”æ‹†å­—ã€•"
  comment_format:
    - erase/^.*$//

# å¿«é€Ÿé‡è¤‡ä¸Šå±
quick_repeat:  
  input: ";d"
  size: 1
  initial_quality: 0

# ------------
# filters
# ------------
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json
  tips: none                                                 # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  exclude_types: [ radical_lookup ]                          # ä¸è½¬æ¢åæŸ¥å†…å®¹
  
# éƒ¨ä»¶æ‹†å­—æ»¤é•œ
radical_reverse_lookup:
  tags: [ radical_lookup ]
  # dictionary ä¸ºæ‹¼éŸ³æ ‡æ³¨æ¥æºã€‚ç›®å‰æ˜¯æ˜¾ç¤ºæœ¬æ–¹æ¡ˆè¯åº“çš„æ³¨éŸ³ï¼Œå¯å»éƒ¨ä»¶æ‹†å­—æ–¹æ¡ˆä¸‹è½½æ›´å…¨çš„ã€å¸¦å£°è°ƒçš„ã€å·²ç¼–è¯‘å¥½çš„è¯å…¸
  # https://github.com/mirtlecn/rime-radical-pinyin?tab=readme-ov-file#%E5%8F%8D%E6%9F%A5%E5%B8%A6%E5%A3%B0%E8%B0%83%E6%B3%A8%E9%9F%B3
  dictionary: rime_ice
  # comment_format:     # è‡ªå®šä¹‰ commentï¼Œä¾‹å¦‚åœ¨å·¦å³åŠ ä¸Šæ‹¬å·
  #  - xform/^/(/
  #  - xform/$/)/

chaifen:
  option_name: chaifen
  opencc_config: moran_chaifen.json
  tips: char
  show_in_comment: true
  comment_form:
    - "xform/-/ /"

pinyinhint:
  option_name: pinyinhint
  opencc_config: moran_pinyinhint.json
  tips: char
  show_in_comment: true

emoji:
  opencc_config: emoji.json
  option_name: emoji
  tips: none

std_hk:
  opencc_config: t2hk.json
  option_name: std_hk
  #tips: all

std_tw:
  opencc_config: t2tw.json
  option_name: std_tw
  #tips: all

std_dzing:
  opencc_config: moran_dzing.json
  option_name: std_dzing
  tips: all


# ------------
# moran custom
# ------------
moran:
  # ç°¡å¿«ç¢¼æç¤ºç¬¦
  # ä¿®æ”¹çˆ² "" å¯å–æ¶ˆæç¤ºç¬¦
  # å»ºè­°åœ¨ç†Ÿæ‚‰ç°¡ç¢¼å¾Œå†å–æ¶ˆ
  quick_code_indicator: "âš¡ï¸"

  # è©è¼”åŠŸèƒ½
  # ç•¶è¼¸å…¥äºŒå­—æˆ–ä¸‰å­—è©æ™‚ï¼Œå…è¨±è©æœ«è¼¸å…¥ *ä¸€ä½* è¼”åŠ©ç¢¼ç¯©é¸è©èªã€‚
  # ä¾‹å¦‚è¼¸å…¥ lmjxz å¾—åˆ°ã€Œé€£æ¥ã€ï¼Œè¼¸å…¥ lmjxj å¾—åˆ°ã€Œéˆæ¥ã€ã€‚
  # ä½†æ˜¯èˆ‡å­—è¼”è¼¸å…¥æ–¹æ³•ä¸åŒï¼Œè©è¼”åœ¨ç”Ÿæ•ˆå¾Œ *ä¸èƒ½* åœ¨å¥æœ«ç¹¼çºŒè¼¸å…¥å½¢æˆæ•´
  # å¥â€”â€”é€™å€‹åŠŸèƒ½åƒ…ç”¨æ–¼ã€Œè©èªç¯©é¸ã€ã€‚å› æ­¤ï¼Œé€™å€‹åŠŸèƒ½åƒ…é©åˆç¿’æ…£æ–¼ä»¥è©èª
  # çˆ²å–®ä½è¼¸å…¥çš„ç”¨æˆ¶ï¼Œå› æ­¤é»˜èªæ˜¯é—œé–‰çš„ã€‚
  #
  # é–‹å•“å¾Œï¼Œè©è¼”ç¯©é¸çš„è©èªæœƒå¸¶æœ‰è¼”åŠ©ç¢¼æç¤ºï¼Œä¾‹å¦‚ã€Œéˆæ¥ã€å¾Œæœƒæœ‰ã€Œjfã€ï¼Œ
  # æ„æ€æ˜¯è¼¸å…¥ j *æˆ–* f éƒ½å¯ä»¥å®šä½åˆ°é€™å€‹è©ï¼Œè€Œä¸æ˜¯èªªè¦åŒæ™‚è¼¸å…¥ jf å…©å€‹ç¢¼
  # ï¼ˆç›¸åï¼ŒåŒæ™‚è¼¸å…¥ jf å…©ç¢¼å¾Œåè€Œç„¡æ³•å¾—åˆ°è©²é¸é …ï¼‰ã€‚
  enable_word_filter: false

  # ã€Œå‡ºç°¡è®“å…¨ã€ç›¸é—œè¨­ç½®
  # ç•¶ä¸€å€‹å­—å…·æœ‰ç°¡ç¢¼æ™‚ï¼Œæ‰“å…¶å…¨ç¢¼ï¼ˆä¸è«–æ˜¯ yyxx é‚„æ˜¯ yyxxoï¼‰éƒ½æœƒå°è‡´è©²
  # å­—è®“å‡ºé¦–ä½ï¼Œè€Œè¢«æ¨é²åˆ°å¾Œä½ã€‚
  ijrq:
    enable: true       # æ˜¯å¦å•“ç”¨å‡ºç°¡è®“å…¨ï¼Ÿ
    #defer: 5          # å»¶é²å¤šå°‘ä½ï¼Ÿè‹¥ä¸è¨­ç½®è¯¥é¡¹ï¼Œæˆ–å€¼å°æ–¼ç­‰æ–¼ 0ï¼Œå‰‡æ¨é²åˆ°ç¬¬äºŒé çš„é¦–é¸
    show_hint: true    # è‹¥è®“å…¨ï¼Œå‰‡æç¤ºç°¡ç¢¼æ‰“æ³•

  # å–®å­—è¼”åŠ©ç¢¼æç¤º
  # æ³¨ï¼šæœƒé¡¯ç¤ºå‡ºæ‰€æœ‰å¯èƒ½çš„è¼”åŠ©ç¢¼
  enable_aux_hint: false

  # ç°¡å¿«ç¢¼æç¤ºï¼ˆåŒ…æ‹¬å­—å’Œè©ï¼‰
  # ä¾‹å¦‚ è¼¸å…¥ yy te er è‹±ç‰¹çˆ¾ æœƒæç¤ºã€Œâš¡yteã€ï¼Œå³ä½¿ç”¨ yte å¯ä»¥æ‰“å‡ºé€™å€‹è©
  enable_quick_code_hint: false

  # è¼¸å…¥å››ç¢¼æ™‚ï¼Œå¦‚æœç°¡ç¢¼ç¢¼è¡¨ä¸­å«æœ‰å°æ‡‰æ¢ç›®ï¼Œå‰‡æ”¾ç½®åœ¨ç¬¬äºŒé¸é …ã€‚
  show_chars_anyway: false   # æ˜¯å¦è¼¸å‡ºç°¡ç¢¼ç¢¼è¡¨å–®å­—ï¼Œä¾‹ï¼šè¼¸å…¥ jwrg æ™‚ï¼Œæ¬¡é¸çˆ²ã€Œä½³ã€
  show_words_anyway: true   # æ˜¯å¦è¼¸å‡ºç°¡ç¢¼ç¢¼è¡¨è©èªï¼Œä¾‹ï¼šè¼¸å…¥ lmsd æ™‚ï¼Œæ¬¡é¸çˆ²ã€Œå…©é¢ä¸‰åˆ€ã€

# é»˜èªå•“ç”¨èªè¨€æ¨¡å‹
__include: moran:/octagram/enable_for_sentence
# è‹¥è¦ç¦ç”¨ï¼Œå¯ç›´æ¥åˆªæ‰ä¸Šé¢çš„ __includeï¼Œæˆ–åœ¨ custom æ–‡ä»¶ä¸­å¯«å…¥ï¼š
# patch:
#   __include: moran:/octagram/disable
